<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile - Learnify</title>
<link rel="stylesheet" href="./styles.css">
<style>
body { font-family: "Poppins", sans-serif; margin: 0; background: #f9f9f9; }
header { background: #1e90ff; color: #fff; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
header h1 { margin: 0; }
header nav a { color: #fff; margin-left: 15px; text-decoration: none; font-weight: 500; }

.profile-container { max-width: 800px; margin: 2rem auto; background: #fff; padding: 2rem; border-radius: 15px; box-shadow: 0 6px 15px rgba(0,0,0,0.1); text-align: center; }

.profile-avatar { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin-bottom: 1rem; border: 3px solid #1e90ff; cursor:pointer; }

h2 { margin: 0.5rem 0; }
p { color: #555; }

.enrolled-courses { margin-top: 2rem; text-align: left; }
.course-item { background: #f1f1f1; padding: 0.8rem 1rem; border-radius: 10px; margin: 0.5rem 0; }

.logout-btn, .edit-btn, .save-btn { margin-top: 1rem; padding: 0.8rem 1.5rem; color: #fff; border: none; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: 0.3s; }

.logout-btn { background: #e63946; }
.logout-btn:hover { background: #c82333; }

.edit-btn { background: #1e90ff; margin-right: 10px; }
.edit-btn:hover { background: #155ab6; }

.save-btn { background: #28a745; }
.save-btn:hover { background: #218838; }

input[type="text"], input[type="email"] { padding:0.6rem; width:60%; margin:0.5rem 0; border-radius:8px; border:1px solid #ccc; }

</style>
</head>
<body>

<header>
<div class="navbar-container">
    <h1 class="logo">Learnify</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="dashboard.html">Dashboard</a>
      <a href="profile.html">Profile</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="login.html" id="logoutLink">Logout</a>
    </nav>
</div>
</header>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
// Check if user is logged in
const currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser){
  Swal.fire({
    icon: 'warning',
    title: 'Please login first',
    confirmButtonColor: '#1e90ff'
  }).then(()=> window.location.href = "login.html");
}
</script>

<div class="profile-container">
    <img src="" alt="User Avatar" class="profile-avatar" id="profilePic">

    <h2 id="userName"></h2>
    <p id="userEmail"></p>

    <button class="edit-btn" id="editBtn">Edit Profile</button>
    <button class="save-btn" id="saveBtn" style="display:none;">Save Changes</button>

    <div class="enrolled-courses">
        <h3>Enrolled Courses</h3>
        <div id="myCoursesList"></div>
    </div>

    <button class="logout-btn" id="logoutBtn">Logout</button>
</div>

<script>
let user = currentUser;
const nameEl = document.getElementById("userName");
const emailEl = document.getElementById("userEmail");
const picEl = document.getElementById("profilePic");
const myCoursesList = document.getElementById("myCoursesList");
const editBtn = document.getElementById("editBtn");
const saveBtn = document.getElementById("saveBtn");

// Initialize profile info
function displayProfile() {
  picEl.src = user.avatar || "https://i.pravatar.cc/150";
  nameEl.textContent = user.name;
  emailEl.textContent = user.email;

  let enrolledCourses = JSON.parse(localStorage.getItem('enrolledCourses')) || [];
  if (enrolledCourses.length === 0) {
    myCoursesList.innerHTML = "<p>You have not enrolled in any courses yet.</p>";
  } else {
    myCoursesList.innerHTML = enrolledCourses.map(c => `<div class="course-item">${c}</div>`).join("");
  }
}
displayProfile();

// Edit profile
editBtn.addEventListener("click", () => {
  nameEl.innerHTML = `<input type="text" id="editName" value="${user.name}">`;
  emailEl.innerHTML = `<input type="email" id="editEmail" value="${user.email}">`;
  picEl.style.cursor = "pointer";
  saveBtn.style.display = "inline-block";
  editBtn.style.display = "none";
});

// Change avatar on click
picEl.addEventListener("click", () => {
  if(saveBtn.style.display === "inline-block"){
    Swal.fire({
      title: 'Enter image URL',
      input: 'url',
      inputLabel: 'Profile picture URL',
      inputPlaceholder: 'https://example.com/avatar.jpg',
      showCancelButton: true,
    }).then((result) => {
      if(result.value) {
        picEl.src = result.value;
        user.avatar = result.value;
      }
    });
  }
});

// Save changes
saveBtn.addEventListener("click", () => {
  const newName = document.getElementById("editName").value;
  const newEmail = document.getElementById("editEmail").value;

  user.name = newName;
  user.email = newEmail;

  localStorage.setItem("currentUser", JSON.stringify(user));
  displayProfile();
  saveBtn.style.display = "none";
  editBtn.style.display = "inline-block";
  Swal.fire({
    icon: 'success',
    title: 'Profile updated!',
    confirmButtonColor: '#1e90ff'
  });
});

// Logout
document.getElementById("logoutBtn").addEventListener("click", () => {
  localStorage.removeItem("currentUser");
  Swal.fire({
    icon: 'success',
    title: 'Logged out',
    confirmButtonColor: '#1e90ff'
  }).then(()=> window.location.href = "login.html");
});
</script>
</body>
</html>
